typedef enum : unsigned char {
    no_type,
    motion_type,
    object_type,
    action_type,
    message_type
} wordtype;


typedef struct {
    const char *text;
    unsigned char meaning;
    unsigned char word_type;
} Word;

const Word vocab[] = {
    {.text = "north", .meaning = 0, .word_type = 1},
    {"n", 0, 1},
    {"south", 1, 1},
    {"s", 1, 1},
    {"east", 2, 1},
    {"e", 2, 1},
    {"west", 3, 1},
    {"w", 3, 1},
    {"ne", 4, 1},
    {"se", 5, 1},
    {"nw", 6, 1},
    {"sw", 7, 1},
    {"upwar", 8, 1},
    {"up", 8, 1},
    {"u", 8, 1},
    {"above", 8, 1},
    {"ascen", 8, 1},
    {"downw", 9, 1},
    {"down", 9, 1},
    {"d", 9, 1},
    {"desce", 9, 1},
    {"left", 10, 1},
    {"right", 11, 1},
    {"inwar", 12, 1},
    {"insid", 12, 1},
    {"in", 12, 1},
    {"out", 13, 1},
    {"outsi", 13, 1},
    {"exit", 13, 1},
    {"leave", 13, 1},
    {"forwa", 14, 1},
    {"conti", 14, 1},
    {"onwar", 14, 1},
    {"back", 15, 1},
    {"retur", 15, 1},
    {"retre", 15, 1},
    {"over", 16, 1},
    {"acros", 17, 1},
    {"upstr", 18, 1},
    {"downs", 19, 1},
    {"enter", 20, 1},
    {"crawl", 21, 1},
    {"jump", 22, 1},
    {"climb", 23, 1},
    {"look", 24, 1},
    {"exami", 24, 1},
    {"touch", 24, 1},
    {"descr", 24, 1},
    {"cross", 25, 1},
    {"road", 26, 1},
    {"hill", 26, 1},
    {"fores", 27, 1},
    {"valle", 28, 1},
    {"build", 29, 1},
    {"house", 29, 1},
    {"gully", 30, 1},
    {"strea", 31, 1},
    {"depre", 32, 1},
    {"entra", 33, 1},
    {"cave", 34, 1},
    {"rock", 35, 1},
    {"slab", 36, 1},
    {"slabr", 36, 1},
    {"bed", 37, 1},
    {"passa", 38, 1},
    {"tunne", 38, 1},
    {"caver", 39, 1},
    {"canyo", 40, 1},
    {"awkwa", 41, 1},
    {"secre", 42, 1},
    {"bedqu", 43, 1},
    {"reser", 44, 1},
    {"giant", 45, 1},
    {"orien", 46, 1},
    {"shell", 47, 1},
    {"barre", 48, 1},
    {"broke", 49, 1},
    {"debri", 50, 1},
    {"view", 51, 1},
    {"fork", 52, 1},
    {"pit", 53, 1},
    {"slit", 54, 1},
    {"crack", 55, 1},
    {"dome", 56, 1},
    {"hole", 57, 1},
    {"wall", 58, 1},
    {"hall", 59, 1},
    {"room", 60, 1},
    {"floor", 61, 1},
    {"stair", 62, 1},
    {"steps", 63, 1},
    {"cobbl", 64, 1},
    {"surfa", 65, 1},
    {"dark", 66, 1},
    {"low", 67, 1},
    {"outdo", 68, 1},
    {"y2", 69, 1},
    {"xyzzy", 70, 1},
    {"plugh", 71, 1},
    {"plove", 72, 1},
    {"main", 73, 1},
    {"offic", 73, 1},
    {"null", 74, 1},
    {"nowhe", 74, 1},
    {"key", 1, 2},
    {"keys", 1, 2},
    {"lamp", 2, 2},
    {"lante", 2, 2},
    {"headl", 2, 2},
    {"grate", 3, 2},
    {"cage", 5, 2},
    {"rod", 6, 2},
    {"bird", 10, 2},
    {"door", 11, 2},
    {"pillo", 12, 2},
    {"velve", 12, 2},
    {"snake", 13, 2},
    {"fissu", 14, 2},
    {"table", 16, 2},
    {"clam", 17, 2},
    {"oyste", 18, 2},
    {"magaz", 19, 2},
    {"issue", 19, 2},
    {"spelu", 19, 2},
    {"\"spel", 19, 2},
    {"dwarf", 20, 2},
    {"dwarv", 20, 2},
    {"knife", 21, 2},
    {"knive", 21, 2},
    {"food", 22, 2},
    {"ratio", 22, 2},
    {"bottl", 23, 2},
    {"jar", 23, 2},
    {"water", 24, 2},
    {"h2o", 24, 2},
    {"oil", 25, 2},
    {"mirro", 26, 2},
    {"plant", 28, 2},
    {"beans", 28, 2},
    {"stala", 31, 2},
    {"shado", 32, 2},
    {"figur", 32, 2},
    {"axe", 34, 2},
    {"drawi", 35, 2},
    {"pirat", 36, 2},
    {"drago", 37, 2},
    {"chasm", 39, 2},
    {"troll", 41, 2},
    {"bear", 45, 2},
    {"messa", 46, 2},
    {"volca", 47, 2},
    {"geyse", 47, 2},
    {"vendi", 48, 2},
    {"machi", 48, 2},
    {"batte", 49, 2},
    {"moss", 50, 2},
    {"carpe", 50, 2},
    {"gold", 51, 2},
    {"nugge", 51, 2},
    {"diamo", 52, 2},
    {"silve", 53, 2},
    {"bars", 53, 2},
    {"jewel", 54, 2},
    {"coins", 55, 2},
    {"chest", 56, 2},
    {"box", 56, 2},
    {"treas", 56, 2},
    {"eggs", 57, 2},
    {"egg", 57, 2},
    {"nest", 57, 2},
    {"tride", 58, 2},
    {"ming", 59, 2},
    {"vase", 59, 2},
    {"shard", 59, 2},
    {"potte", 59, 2},
    {"emera", 60, 2},
    {"plati", 61, 2},
    {"pyram", 61, 2},
    {"pearl", 62, 2},
    {"persi", 63, 2},
    {"rug", 63, 2},
    {"spice", 65, 2},
    {"chain", 66, 2},
    {"take", 1, 3},
    {"carry", 1, 3},
    {"keep", 1, 3},
    {"catch", 1, 3},
    {"captu", 1, 3},
    {"steal", 1, 3},
    {"get", 1, 3},
    {"tote", 1, 3},
    {"drop", 2, 3},
    {"relea", 2, 3},
    {"free", 2, 3},
    {"disca", 2, 3},
    {"dump", 2, 3},
    {"open", 3, 3},
    {"unloc", 3, 3},
    {"close", 4, 3},
    {"lock", 4, 3},
    {"light", 5, 3},
    {"on", 5, 3},
    {"extin", 6, 3},
    {"off", 6, 3},
    {"wave", 7, 3},
    {"shake", 7, 3},
    {"swing", 7, 3},
    {"calm", 8, 3},
    {"placa", 8, 3},
    {"tame", 8, 3},
    {"walk", 9, 3},
    {"run", 9, 3},
    {"trave", 9, 3},
    {"go", 9, 3},
    {"proce", 9, 3},
    {"explo", 9, 3},
    {"goto", 9, 3},
    {"follo", 9, 3},
    {"turn", 9, 3},
    {"nothi", 10, 3},
    {"pour", 11, 3},
    {"eat", 12, 3},
    {"devou", 12, 3},
    {"drink", 13, 3},
    {"rub", 14, 3},
    {"throw", 15, 3},
    {"toss", 15, 3},
    {"wake", 16, 3},
    {"distu", 16, 3},
    {"feed", 17, 3},
    {"fill", 18, 3},
    {"break", 19, 3},
    {"smash", 19, 3},
    {"shatt", 19, 3},
    {"blast", 20, 3},
    {"deton", 20, 3},
    {"ignit", 20, 3},
    {"blowu", 20, 3},
    {"attac", 21, 3},
    {"kill", 21, 3},
    {"fight", 21, 3},
    {"hit", 21, 3},
    {"strik", 21, 3},
    {"slay", 21, 3},
    {"say", 22, 3},
    {"chant", 22, 3},
    {"sing", 22, 3},
    {"utter", 22, 3},
    {"mumbl", 22, 3},
    {"read", 23, 3},
    {"perus", 23, 3},
    {"fee", 24, 3},
    {"fie", 24, 3},
    {"foe", 24, 3},
    {"foo", 24, 3},
    {"fum", 24, 3},
    {"brief", 25, 3},
    {"find", 26, 3},
    {"where", 26, 3},
    {"inven", 27, 3},
    {"score", 28, 3},
    {"quit", 29, 3},
    {"abra", 0, 4},
    {"abrac", 0, 4},
    {"opens", 0, 4},
    {"sesam", 0, 4},
    {"shaza", 0, 4},
    {"hocus", 0, 4},
    {"pocus", 0, 4},
    {"help", 1, 4},
    {"?", 1, 4},
    {"tree", 2, 4},
    {"trees", 2, 4},
    {"dig", 3, 4},
    {"excav", 3, 4},
    {"lost", 4, 4},
    {"mist", 7, 4},
    {"fuck", 8, 4},
    {"stop", 10, 4},
    {"info", 11, 4},
    {"infor", 11, 4},
    {"swim", 12, 4},
};

#define VOCAB_SIZE (sizeof(vocab)/sizeof(Word))

/**
 * Encodes a short, 5-character NUL-terminated string into a unique
 * 64-bit integer by packing the 7-bit ASCII value of each character.
 */
static uint64_t encode_word(const char* word) {
    uint64_t r = 0;
    for (size_t i = 0; i < 5 && word[i] != '\0'; i++) {
        r = (r << 7) | word[i];
    }
    return r;
}

int lookup(const char* word) {
    uint64_t r = encode_word(word);
    int i;
    switch (r) {
#include "vocab_jmp.h"
    default:
        i = -1;
    }
    if (i != -1 && strncmp(vocab[i].text, word, 5) != 0) {
        i = -1; // collision - word not in vocab
    }
    return i;
}

void generate_jmp_table() {
    for (size_t i = 0; i < VOCAB_SIZE; i++) {
        uint64_t r = encode_word(vocab[i].text);
        printf("case %llu: i=%zu; break;\n", r, i);
    }
}



